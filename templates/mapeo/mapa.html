{% extends "mapeo/base.html" %}

{% block extra_js %}
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript" src="/static/monitoreo/js/markerclusterer.js"></script>
<script type="text/javascript" src="/static/monitoreo/js/infobox.js"></script>
<script type="text/javascript">
    var map;
    var markers = [];
    $(document).ready(function () {     
        var infowindow = new google.maps.InfoWindow();
        var myLatlng = new google.maps.LatLng(13,-85);
        var myOptions = {
            zoom: 7,
            mapTypeControl: true,
            scaleControl: false,
            scrollwheel: false,
            center: myLatlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }
        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        var image = new google.maps.MarkerImage('/static/monitoreo/images/custom_marker.png',
        new google.maps.Size(15, 32),
        new google.maps.Point(0,0),
        new google.maps.Point(0, 32));
            $.getJSON("{% url 'obtener-lista' %}", function(data){
                $.each(data, function(i, elemento){
                    var latlng = new google.maps.LatLng(elemento.lat, elemento.lon);
                    var marker = new google.maps.Marker({
                        position: latlng,
                        map: map,
                        title: elemento.nombre,
                        icon: image,                        
                        item: '',
                        id: elemento.id                        
                    });                    
                    markers.push(marker);                    
                });
                var markerCluster = new MarkerClusterer(map, markers);
            });
                
    });
    
</script>	
{% endblock extra_js %}

{% block contenido %}
<style>
    .mapa{
    	margin: 0 auto;
    	float: left;
    	width: 708px;    
    }
    .mapa #map_canvas { 
        height: 500px;
        width: 700px;
        margin: 0 auto;
    }
    #map_canvas img,.google-maps img{max-width:none;}
</style>

	<div class="row mapa">
    	<div id="map_canvas"></div>
    </div>

{% endblock contenido %}